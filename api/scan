<section id="scan" style="max-width:820px;margin:10px auto 60px;padding:24px;border:1px solid #eee;border-radius:12px;background:#fff;font-family:system-ui">
  <h2>Gratis quick scan</h2>
  <form id="scanForm">
    <input id="scanUrl" type="url" placeholder="https://jouwsite.nl" required style="padding:10px;width:68%">
    <input id="scanEmail" type="email" placeholder="jij@bedrijf.nl" required style="padding:10px;width:68%;margin-top:6px">
    <button style="padding:10px 16px;margin-top:8px">Scan</button>
  </form>
  <div id="scanMsg" style="margin-top:8px;font-size:14px"></div>
</section>
<script>
document.getElementById('scanForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const msg = document.getElementById('scanMsg');
  msg.textContent = 'Scannen...';
  const res = await fetch('/api/scan', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({
      url: document.getElementById('scanUrl').value.trim(),
      email: document.getElementById('scanEmail').value.trim()
    })
  });
  const data = await res.json().catch(()=>({}));
  if (res.ok && data.ok) {
    msg.innerHTML = `Klaar ✅ Score: <b>${data.score}</b> — <a href="${data.report_url}" target="_blank">Bekijk rapport</a>`;
  } else {
    msg.textContent = 'Mislukt: ' + (data.error || res.statusText);
  }
});
</script>
